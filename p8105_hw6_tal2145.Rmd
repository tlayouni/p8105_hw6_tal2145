---
title: "Homework 6"
author: Troy Layouni
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

## Problem 1
***

#### Part 1: Loading and cleaning `birthweight` dataset

* Loading csv 
* cleaning variable types 

```{r}
birthweight_df = 
  read_csv("./data/birthweight.csv") %>% 
  mutate(
    mrace = as.factor(mrace), 
    mrace = recode(mrace, "1" = "White", "2" = "Black", "3" = "Asian", "4" = "Puerto Rican", "8" = "Other", "9" = "Unknown"),
    frace = as.factor(frace), 
    frace = recode(frace, "1" = "White", "2" = "Black", "3" = "Asian", "4" = "Puerto Rican", "8" = "Other", "9" = "Unknown"),
    malform = as.factor(malform),
    malform = recode(malform, "1" = "absent", "2" = "absent"),
    babysex = as.factor(babysex),
    babysex = recode(babysex, "1" = "male", "2" = "female")
  )
```

#### Part 2: Building a linear model

First proposed linear model: 

* this model was created through a data-driven process, adding in variables one at a time, to see whether they were significant and whether the adjusted r-squared changed by an appreciable amount to determine whether the variable should be included in my regression model. gaweeks was always included as it is a key factor in an infant's birthweight.

```{r}
birthweight_df = 
  birthweight_df %>% 
  mutate(
    mrace = fct_infreq(mrace)
  )

fit = lm(bwt ~ bhead + blength + delwt + mrace + gaweeks, data = birthweight_df)

summary(fit)
```





